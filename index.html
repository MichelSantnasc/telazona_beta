<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="alternate" hreflang="pt" href="https://telazona.live/">
<link rel="alternate" hreflang="en" href="https://telazona.live/?lang=en">
<link rel="alternate" hreflang="es" href="https://telazona.live/?lang=es">
  <!-- SEO Básico -->
<title>TelaZona | Multiview de Lives YouTube, Twitch e Kick</title>
<meta name="description" content="Assista múltiplas lives simultaneamente em um único lugar. Multiview rápido, leve e gratuito para YouTube, Twitch e Kick.">
<meta name="keywords" content="multiview, assistir lives, twitch multiview, youtube multiview, kick multiview, várias lives ao mesmo tempo, telazona">
<meta name="author" content="TelaZona">
<meta name="robots" content="index, follow">

<!-- Canonical -->
<link rel="canonical" href="https://telazona.live/">

<!-- Open Graph (Facebook / Discord / WhatsApp) -->
<meta property="og:title" content="TelaZona | Multiview de Lives">
<meta property="og:description" content="Assista várias lives simultaneamente com latência zero. Suporte para YouTube, Twitch e Kick.">
<meta property="og:url" content="https://telazona.live/">
<meta property="og:type" content="website">
<meta property="og:image" content="https://telazona.live/og-image.png">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="TelaZona | Multiview de Lives">
<meta name="twitter:description" content="Multiview leve e rápido para YouTube, Twitch e Kick.">
<meta name="twitter:image" content="https://telazona.live/og-image.png">

<!-- Tema navegador mobile -->
<meta name="theme-color" content="#0f0f0f">
  
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;600;800&family=Silkscreen:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/@phosphor-icons/web"></script>

  <style>
    :root {
      --bg: #030303;
      --surface: rgba(18, 18, 18, 0.7);
      --surface-solid: #121212;
      --border: rgba(255, 255, 255, 0.08);
      --text: #ffffff;
      --text-dim: #94a3b8;
      --accent: #00ffa3; 
      --accent-glow: rgba(0, 255, 163, 0.4);
      --radius-lg: 24px;
      --radius-md: 14px;
      --header-h: 72px;
      --chat-w: 320px;
      --ease: cubic-bezier(0.4, 0, 0.2, 1);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; outline: none; }
    
    body {
      font-family: 'Plus Jakarta Sans', sans-serif;
      background-color: var(--bg);
      color: var(--text);
      overflow: hidden;
      height: 100vh;
      -webkit-font-smoothing: antialiased;
    }

    .silkscreen { font-family: 'Silkscreen', cursive; text-transform: uppercase; }

    header {
      position: fixed; top: 0; left: 0; width: 100%; height: var(--header-h);
      background: rgba(5, 5, 5, 0.6);
      backdrop-filter: blur(20px) saturate(180%);
      border-bottom: 1px solid var(--border);
      display: flex; align-items: center; justify-content: space-between;
      padding: 0 40px; z-index: 1000;
      transition: transform 0.5s var(--ease), opacity 0.5s var(--ease);
    }
    header.hidden { transform: translateY(-100%); opacity: 0; }

    .logo-container { display: flex; align-items: center; gap: 14px; text-decoration: none; color: inherit; }
    .logo-mark { 
      width: 36px; height: 36px; background: var(--accent); 
      border-radius: 10px; box-shadow: 0 0 20px var(--accent-glow);
      display: flex; align-items: center; justify-content: center;
      color: #000; font-size: 20px;
    }
    .logo-text { font-size: 24px; font-weight: 800; letter-spacing: -1px; }

    .nav-group { display: flex; gap: 12px; align-items: center; }

    .btn {
      background: var(--surface);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 10px 18px;
      border-radius: var(--radius-md);
      font-size: 13px; font-weight: 600;
      cursor: pointer; display: flex; align-items: center; gap: 8px;
      transition: all 0.3s var(--ease);
      backdrop-filter: blur(5px);
    }
    .btn:hover { background: var(--accent); color: #000; border-color: var(--accent); transform: translateY(-2px); }
    .btn-primary { background: var(--accent); color: #000; border: none; box-shadow: 0 4px 15px rgba(0, 255, 163, 0.2); }
    .btn-icon { padding: 10px; }
    .btn-danger.confirming { background: #ff4444; color: white; border-color: #ff4444; }

    main {
      height: 100vh; display: flex;
      padding-top: var(--header-h);
      transition: padding 0.5s var(--ease);
    }
    main.full-screen { padding-top: 0; }

    #grid {
      flex: 1; display: grid; gap: 8px; padding: 8px;
      background: #000; align-content: stretch;
      transition: all 0.5s var(--ease);
    }

    .live-wrapper {
      position: relative; background: #0a0a0a;
      border-radius: 10px; overflow: hidden;
      border: 1px solid var(--border); 
      transition: all 0.3s var(--ease);
      animation: zoomIn 0.5s var(--ease);
    }
    .live-wrapper:hover { border-color: var(--accent); z-index: 5; }
    .live-wrapper iframe { width: 100%; height: 100%; border: none; pointer-events: auto; }

    @keyframes zoomIn {
      from { opacity: 0; transform: scale(0.98); }
      to { opacity: 1; transform: scale(1); }
    }

    .live-controls {
      position: absolute; top: 10px; right: 10px;
      display: flex; gap: 8px; opacity: 0; transition: 0.3s; z-index: 10;
    }
    .live-wrapper:hover .live-controls { opacity: 1; }

    #chat-sidebar {
      width: 0; background: var(--surface-solid);
      border-left: 1px solid var(--border);
      display: flex; flex-direction: column;
      transition: width 0.4s var(--ease);
      overflow: hidden;
    }
    #chat-sidebar.open { width: var(--chat-w); }

    .chat-header {
      padding: 16px; border-bottom: 1px solid var(--border);
      display: flex; flex-direction: column; gap: 10px;
      transition: all 0.3s var(--ease);
      max-height: 200px;
      overflow: hidden;
    }
    .chat-header.collapsed {
      max-height: 0; padding-top: 0; padding-bottom: 0; border-bottom: none; opacity: 0;
    }

    .chat-header select {
      background: #1a1a1a; color: #fff; border: 1px solid var(--border);
      padding: 8px; border-radius: 8px; font-family: inherit; font-size: 12px;
      cursor: pointer; appearance: none; width: 100%;
    }

    #toggle-selectors {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-top: none;
      color: var(--text-dim);
      width: 40px; height: 20px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; margin: 0 auto;
      border-bottom-left-radius: 10px; border-bottom-right-radius: 10px;
      z-index: 20; transition: color 0.3s;
    }
    #toggle-selectors:hover { color: var(--accent); }

    #chat-content { flex: 1; display: flex; flex-direction: column; background: #000; }
    #chat-content iframe { width: 100%; flex: 1; border: none; display: none; }

    #float-bar {
      position: fixed; bottom: 32px; left: 50%; transform: translateX(-50%);
      background: rgba(18, 18, 18, 0.8); backdrop-filter: blur(20px);
      padding: 8px; border-radius: 40px; border: 1px solid var(--border);
      display: flex; gap: 8px; z-index: 1100;
      box-shadow: 0 20px 50px rgba(0,0,0,0.6);
      transition: all 0.4s var(--ease);
    }
    #float-bar.hidden { opacity: 0; transform: translate(-50%, 80px); pointer-events: none; }

    .icon-circle {
      width: 44px; height: 44px; border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; color: var(--text-dim); transition: 0.3s;
      font-size: 18px;
    }
    .icon-circle:hover { background: var(--accent); color: #000; transform: scale(1.1); }
    .icon-circle.active { color: var(--accent); background: rgba(0, 255, 163, 0.1); }

    .overlay {
      position: fixed; inset: 0; background: rgba(0,0,0,0.9);
      backdrop-filter: blur(15px); z-index: 2000;
      opacity: 0; visibility: hidden; transition: 0.3s;
    }
    .overlay.active { opacity: 1; visibility: visible; }

    .modal {
      position: fixed; top: 50%; left: 50%; transform: translate(-50%, -40%);
      background: #111; border: 1px solid var(--border);
      border-radius: var(--radius-lg); padding: 40px; width: 95%; max-width: 520px;
      z-index: 2001; opacity: 0; visibility: hidden; transition: 0.5s var(--ease);
    }
    .modal.active { opacity: 1; visibility: visible; transform: translate(-50%, -50%); }

    .modal input {
      width: 100%; background: #000; border: 1px solid var(--border);
      padding: 16px; border-radius: var(--radius-md); color: #fff;
      font-size: 14px; margin: 20px 0; transition: 0.3s;
    }
    .modal input:focus { border-color: var(--accent); }

    #hero {
      position: absolute; inset: 0; display: flex; flex-direction: column;
      align-items: center; justify-content: center; text-align: center; padding: 30px;
      z-index: 1;
    }
    .hero-title { 
      font-size: clamp(3rem, 10vw, 6rem); font-weight: 900; line-height: 0.85; margin-bottom: 20px; 
    }

#toast {
  position: fixed;
  bottom: 100px;
  right: 40px;
  background: var(--accent);
  color: #000;
  padding: 12px 24px;
  border-radius: 12px;
  font-weight: 800;
  z-index: 9999;

  opacity: 0;
  transform: translateY(20px);
  pointer-events: none;
  transition: opacity 0.3s ease, transform 0.3s ease;
}

#toast.show {
  opacity: 1;
  transform: translateY(0);
}

    /* Modal Destaques */
    #modal-featured { max-width: 720px; }
    #featured-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 20px;
      max-height: 60vh;
      overflow-y: auto;
      padding: 10px;
    }
    .featured-card {
      background: var(--surface-solid);
      border: 1px solid var(--border);
      border-radius: var(--radius-md);
      overflow: hidden;
      transition: all 0.35s var(--ease);
    }
    .featured-card:hover {
      transform: translateY(-8px);
      box-shadow: 0 0 40px var(--accent-glow);
      border-color: var(--accent);
    }
    .featured-header {
      padding: 16px 20px;
      background: rgba(0,255,163,0.07);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .featured-title { font-size: 20px; font-weight: 800; color: var(--accent); }
    .featured-count {
      background: rgba(0,255,163,0.25);
      color: #000;
      padding: 5px 14px;
      border-radius: 999px;
      font-size: 13px;
      font-weight: 700;
    }
    .featured-preview {
      padding: 18px 20px;
      color: var(--text-dim);
      font-size: 13.5px;
      line-height: 1.5;
      min-height: 100px;
    }
    .featured-preview div { margin: 6px 0; word-break: break-all; opacity: 0.9; }
    .featured-action { padding: 16px 20px; border-top: 1px solid var(--border); text-align: center; }

    @media (max-width: 768px) {
      header { padding: 0 20px; }
      .logo-text { font-size: 18px; }
      #featured-grid { grid-template-columns: 1fr; }
    }


.hamburger-btn {
  display: none;
  background: none;
  border: none;
  font-size: 26px;
  color: var(--text);
  cursor: pointer;
}

.desktop-controls {
  display: flex;
  gap: 10px;
  align-items: center;
}

@media (max-width: 768px) {

  .hamburger-btn {
    display: block;
  }

  .desktop-controls {
    position: fixed;
    top: 0;
    right: -100%;
    width: 260px;
    height: 100%;
    background: var(--bg-card);
    flex-direction: column;
    padding: 90px 20px;
    gap: 15px;
    transition: 0.3s ease;
    z-index: 9998;
  }

  .desktop-controls.open {
    right: 0;
  }
}

@media (max-width: 768px) {

  body {
    overflow: auto;
    height: auto;
  }

  main {
    flex-direction: column;
    height: auto;
    padding-top: var(--header-h);
  }

  #grid {
    grid-template-columns: 1fr !important;
    gap: 0 !important;
    padding: 0 !important;
  }

  .live-wrapper {
border-bottom: 1px solid rgba(255,255,255,0.05);
  }

  .live-wrapper iframe {
    width: 100%;
    aspect-ratio: 16 / 9;
    height: auto;
  }

  /* CHAT NO FLUXO NORMAL */
  #chat-sidebar {
    position: relative;
    width: 100%;
  max-width: 420px;
  margin: 0 auto;
    border-left: none;
    border-top: 1px solid var(--border);
    transform: none;
  }

  #chat-sidebar:not(.open) {
    display: none;
  }

 #chat-sidebar.open {
  display: flex;
  min-height: 420px;
}

  #chat-content iframe {
    height: 420px;
  }

}

@media (max-width: 768px) {

  .live-controls {
    opacity: 1 !important;
    pointer-events: auto !important;
  }

}

@media (max-width: 768px) {

#float-bar {
  position: fixed;
  bottom: 20px;
  left: 50%;

  transform: translate(-50%, 20px);
  opacity: 0;

  transition: transform .3s ease, opacity .3s ease;

  display: flex;
  gap: 14px;
  padding: 12px 20px;
  border-radius: 999px;

  backdrop-filter: blur(18px);
  background: rgba(20,20,20,0.75);

  z-index: 2000;
}

/* quando aparece */
#float-bar.show {
  transform: translate(-50%, 0);
  opacity: 1;
}

}

@media (max-width: 768px) {

  main {
    padding-left: 0 !important;
    padding-right: 0 !important;
  }

  #grid {
    padding: 0 !important;
  }

  #chat-sidebar {
    width: 100vw !important;
    max-width: 100% !important;
    margin: 0 !important;
    border-left: none;
    border-top: 1px solid var(--border);
  }

  #chat-content {
    width: 100%;
  }

  #chat-content iframe {
    width: 100%;
  }

}
  </style>

  <script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "TelaZona",
  "url": "https://telazona.live/",
  "description": "Plataforma multiview para assistir várias lives simultaneamente do YouTube, Twitch e Kick.",
  "potentialAction": {
    "@type": "SearchAction",
    "target": "https://telazona.live/?q={search_term_string}",
    "query-input": "required name=search_term_string"
  }
}
</script>
</head>
<body>

<header id="header">

  <a href="#" class="logo-container">
    <!--  <div class="logo-mark">
     <i class="ph-fill ph-monitor-play"></i>
    </div> -->
    <div class="logo-text silkscreen">TELAZONA</div>
  </a>

  <!-- Hamburger (sempre visível no mobile) -->
  <button id="hamburgerBtn" class="hamburger-btn">
    <i class="ph ph-list"></i>
  </button>

  <!-- Menu Desktop / Mobile -->
  <div class="desktop-controls" id="mobileMenu">
    <button class="btn" id="featured-btn" style="display: none;">
      <i class="ph ph-sparkle"></i>
      <span data-i18n="featured">Destaques</span>
    </button>

    <button class="btn btn-primary" id="add-btn">
      <i class="ph ph-plus-bold"></i>
      <span data-i18n="add">Adicionar</span>
    </button>

    <button class="btn btn-icon" id="clear-btn" title="Clique duas vezes para limpar">
      <i class="ph ph-trash"></i>
    </button>

    <button class="btn" id="donate-btn">
      <i class="ph ph-heart"></i>
      <span data-i18n="donate">Doar</span>
    </button>

    <button class="btn btn-icon" id="lang-cycle">
      <i class="ph ph-globe"></i>
      <span id="lang-label">PT</span>
    </button>
  </div>

</header>

  <main id="main-el">
    <!-- Hero -->
    <div id="hero">
      <div class="hero-badge silkscreen" style="font-size: 12px; color: var(--accent); margin-bottom: 15px;" data-i18n="badge">ESTÚDIO MULTIVIEW</div>
      <h1 class="hero-title silkscreen">TELA<br><span style="color: var(--accent)">ZONA</span></h1>
      <p style="color: var(--text-dim); max-width: 450px; margin-bottom: 40px; font-size: 18px;" data-i18n="hero-desc">
        Sintonize múltiplas lives simultaneamente com latência zero.
      </p>
      <button class="btn btn-primary" id="hero-start" style="padding: 18px 48px; font-size: 16px; border-radius: 40px;" data-i18n="start">
        Começar
      </button>
    </div>

    <!-- Grid -->
    <div id="grid" style="display: none;"></div>

    <!-- Chat Sidebar -->
    <aside id="chat-sidebar">
      <div class="chat-header" id="chat-selectors">
        <div style="display:flex; justify-content: space-between; align-items: center;">
          <span style="font-weight: 800; font-size: 11px; letter-spacing: 1px; color: var(--accent)" data-i18n="chat-title">CHATS INTEGRADOS</span>
          <button id="close-chat" style="background:none; border:none; color:#fff; cursor:pointer; font-size: 18px;"><i class="ph ph-x-circle"></i></button>
        </div>
        <select id="chat-select1"></select>
        <div style="display:flex; gap: 8px;">
          <select id="chat-select2" style="display:none; flex: 1;"></select>
          <button id="dual-btn" class="btn btn-icon" style="padding: 8px;"><i class="ph ph-columns"></i></button>
        </div>
      </div>
      <button id="toggle-selectors" title="Ocultar/Mostrar Seletores">
        <i class="ph ph-caret-up" id="toggle-icon"></i>
      </button>

      <div id="chat-content">
        <iframe id="chat-frame1"></iframe>
        <iframe id="chat-frame2"></iframe>
      </div>
    </aside>
  </main>

  <!-- Float Bar -->
  <div id="float-bar" class="hidden">
    <div class="icon-circle" id="ctrl-add"><i class="ph ph-plus-circle"></i></div>
    <div class="icon-circle" id="ctrl-eye"><i class="ph ph-eye-slash"></i></div>
    <div class="icon-circle" id="ctrl-chat" style="display:none;"><i class="ph ph-chat-centered-text"></i></div>
    <div class="icon-circle" id="ctrl-expand"><i class="ph ph-corners-out"></i></div>
  </div>

  <div id="toast"></div>

  <div class="overlay" id="overlay"></div>
  
  <!-- Modal Adicionar -->
  <div class="modal" id="modal-add">
    <h2 class="silkscreen" style="color: var(--accent)" data-i18n="modal-title">Sintonizar</h2>
    <p style="font-size: 14px; margin-top: 10px;" data-i18n="modal-desc">Cole o URL (YouTube, Twitch ou Kick).</p>
    <input type="text" id="url-input" placeholder="https://...">
    <div style="display:flex; gap: 12px; justify-content: flex-end; margin-top: 24px;">
      <button class="btn" id="modal-cancel" data-i18n="cancel">Voltar</button>
      <button class="btn btn-primary" id="modal-confirm" data-i18n="confirm">Sintonizar</button>
    </div>
  </div>

  <!-- Modal Destaques -->
  <div class="modal" id="modal-featured">
    <h2 class="silkscreen" style="color: var(--accent); margin-bottom: 24px;" data-i18n="featuredTitle">LIVES EM DESTAQUE</h2>
    <div id="featured-grid"></div>
    <div style="text-align: center; margin-top: 28px;">
      <button class="btn btn-primary" id="close-featured" style="padding: 14px 48px;" data-i18n="close">Fechar</button>
    </div>
  </div>

  <script>
    // ==================== i18n COMPLETO ====================
const DEFAULT_LANG = "en";

const translations = {

  pt: {
    // UI
    featured: "Destaques",
    add: "Adicionar",
    donate: "Doar",
    badge: "ESTÚDIO MULTIVIEW",
    "hero-desc": "Sintonize múltiplas lives simultaneamente com latência zero.",
    start: "Começar",
    "chat-title": "CHATS INTEGRADOS",
    "modal-title": "Sintonizar",
    "modal-desc": "Cole o URL (YouTube, Twitch ou Kick).",
    cancel: "Voltar",
    confirm: "Sintonizar",
    featuredTitle: "LIVES EM DESTAQUE",
    close: "Fechar",
    chat_sel: "Selecionar Chat",
    addToGrid: "Adicionar ao Grid",
    

    // Toasts
    toast_visible: "Interface visível",
    toast_focus: "Modo foco ativado",
    clear_confirm: "Clique novamente para limpar",
    toast_clear: "Lives removidas",
    toast_live: "Live adicionada",

    toastAdded_one: "+{count} live adicionada",
    toastAdded_other: "+{count} lives adicionadas",
    toastAllAdded: "Todas as lives deste grupo já estão no grid",
    featured_updated: "Destaques atualizados ✨",
    featuredCount_one: "{count} live",
    featuredCount_other: "{count} lives",
    no_featured: "Nenhum destaque carregado ainda."
  },

  en: {
    featured: "Featured",
    add: "Add",
    donate: "Donate",
    badge: "MULTIVIEW STUDIO",
    "hero-desc": "Watch multiple live streams simultaneously with zero latency.",
    start: "Start",
    "chat-title": "INTEGRATED CHATS",
    "modal-title": "Tune In",
    "modal-desc": "Paste the URL (YouTube, Twitch or Kick).",
    cancel: "Back",
    confirm: "Tune In",
    featuredTitle: "FEATURED LIVES",
    close: "Close",
    chat_sel: "Select Chat",
    addToGrid: "Add to Grid",

    toast_visible: "Interface visible",
    toast_focus: "Focus mode enabled",
    clear_confirm: "Click again to clear",
    toast_clear: "Lives removed",
    toast_live: "Live added",

    toastAdded_one: "+{count} live added",
    toastAdded_other: "+{count} lives added",
    toastAllAdded: "All lives from this group are already in the grid",
    featured_updated: "Featured updated ✨",
    featuredCount_one: "{count} live",
    featuredCount_other: "{count} lives",
    no_featured: "No highlights loaded yet."
  },

  es: {
    featured: "Destacados",
    add: "Agregar",
    donate: "Donar",
    badge: "ESTUDIO MULTIVIEW",
    "hero-desc": "Mira múltiples transmisiones en vivo simultáneamente.",
    start: "Comenzar",
    "chat-title": "CHATS INTEGRADOS",
    "modal-title": "Sintonizar",
    "modal-desc": "Pega la URL (YouTube, Twitch o Kick).",
    cancel: "Volver",
    confirm: "Sintonizar",
    featuredTitle: "LIVES DESTACADAS",
    close: "Cerrar",
    chat_sel: "Seleccionar Chat",
    addToGrid: "Agregar a la cuadrícula",

    toast_visible: "Interfaz visible",
    toast_focus: "Modo enfoque activado",
    clear_confirm: "Haz clic de nuevo para limpiar",
    toast_clear: "Lives eliminadas",
    toast_live: "Live añadida",

    toastAdded_one: "+{count} live añadida",
    toastAdded_other: "+{count} lives añadidas",
    toastAllAdded: "Todas las lives de este grupo ya están en la cuadrícula",
    featured_updated: "Destacados actualizados ✨",
    featuredCount_one: "{count} live",
    featuredCount_other: "{count} lives",
    no_featured: "Aún no se han cargado destacados."
  }

};

    
    let lives = [];
    let uiVisible = true;
    let autoHideTimer;
    let clearTimer;
    let isConfirmingClear = false;

    const el = {
      grid: document.getElementById('grid'),
      hero: document.getElementById('hero'),
      header: document.getElementById('header'),
      main: document.getElementById('main-el'),
      floatBar: document.getElementById('float-bar'),
      overlay: document.getElementById('overlay'),
      modalAdd: document.getElementById('modal-add'),
      modalFeatured: document.getElementById('modal-featured'),
      featuredGrid: document.getElementById('featured-grid'),
      urlInput: document.getElementById('url-input'),
      chatSidebar: document.getElementById('chat-sidebar'),
      chatSelect1: document.getElementById('chat-select1'),
      chatSelect2: document.getElementById('chat-select2'),
      chatFrame1: document.getElementById('chat-frame1'),
      chatFrame2: document.getElementById('chat-frame2'),
      ctrlChat: document.getElementById('ctrl-chat'),
      toast: document.getElementById('toast'),
      featuredBtn: document.getElementById('featured-btn'),
      clearBtn: document.getElementById('clear-btn'),
      chatSelectors: document.getElementById('chat-selectors'),
      toggleSelectors: document.getElementById('toggle-selectors'),
      toggleIcon: document.getElementById('toggle-icon'),
      donateBtn: document.getElementById('donate-btn')
    };

    window.featuredLives = [];
    

    // ==================== IDIOMAS ====================
  




    // ==================== TOAST (garantido desaparecer) ====================
function showToast(key, vars = {}, count = null) {
  el.toast.textContent = t(key, vars, count);

  el.toast.classList.remove('show');
  void el.toast.offsetWidth;

  el.toast.classList.add('show');

  clearTimeout(el.toast._timer);
  el.toast._timer = setTimeout(() => {
    el.toast.classList.remove('show');
  }, 1200);
}
 // ==================== DETECTAR IDIOMA AUTOMATICAMENTE ====================
 function detectLanguage() {
  const saved = localStorage.getItem("lang");
  if (saved && translations[saved]) return saved;

  const browserLang = navigator.language.slice(0, 2);
  if (translations[browserLang]) return browserLang;

  return DEFAULT_LANG;
}

let currentLang = detectLanguage();

  // ==================== FUNÇÃO t() PROFISSIONAL COM FALLBACK ====================

function t(key, vars = {}, count = null) {

  let langPack = translations[currentLang] ?? translations[DEFAULT_LANG];

  let finalKey = key;

  // Plural automático
  if (count !== null) {
    finalKey = count === 1 ? key + "_one" : key + "_other";
  }

  // Busca no idioma atual
  let text = langPack[finalKey];

  // Fallback para inglês se não existir
  if (!text && translations[DEFAULT_LANG][finalKey]) {
    text = translations[DEFAULT_LANG][finalKey];
  }

  // Se ainda não existir, retorna a chave
  if (!text) return key;

  // Substituição de variáveis
  Object.keys(vars).forEach(k => {
    text = text.replace(`{${k}}`, vars[k]);
  });

  return text;
}

 // ==================== BOTÃO DE TROCAR IDIOMA ====================

function updateTranslations() {
  document.documentElement.lang = currentLang;

  document.querySelectorAll("[data-i18n]").forEach(el => {
    const key = el.dataset.i18n;
    el.textContent = t(key);
  });

  document.getElementById("lang-label").textContent = currentLang.toUpperCase();
}

document.getElementById("lang-cycle").onclick = () => {

  const langs = Object.keys(translations);
  let index = langs.indexOf(currentLang);

  currentLang = langs[(index + 1) % langs.length];

  localStorage.setItem("lang", currentLang);

  updateTranslations();

};



    // ==================== CONTROLE DE INTERFACE (auto-hide) ====================
    function resetAutoHide() {
      if (lives.length === 0) return;
      el.floatBar.classList.remove('hidden');
      clearTimeout(autoHideTimer);
      if (!uiVisible) {
        autoHideTimer = setTimeout(() => {
          if (!el.modalAdd.classList.contains('active') && !el.modalFeatured.classList.contains('active')) {
            el.floatBar.classList.add('hidden');
          }
        }, 3000);
      }
    }

  // ==================== MENU HAMBURGER ====================
 const hamburgerBtn = document.getElementById('hamburgerBtn');
const mobileMenu = document.getElementById('mobileMenu');

hamburgerBtn.addEventListener('click', () => {
  mobileMenu.classList.toggle('open');
});

document.addEventListener('click', e => {
  if (
    mobileMenu.classList.contains('open') &&
    !mobileMenu.contains(e.target) &&
    !hamburgerBtn.contains(e.target)
  ) {
    mobileMenu.classList.remove('open');
  }
});


 // ==================== BOTAO EXCLUIR ====================
document.addEventListener("click", e => {
  const live = e.target.closest(".live-wrapper");

  document.querySelectorAll(".live-wrapper")
    .forEach(l => l.classList.remove("active"));

  if (live && window.innerWidth <= 768) {
    live.classList.add("active");
  }
});

    // ==================== PARSE URL ====================
function parseUrl(url) {
  if (!url) return null;

  url = url.trim().toLowerCase();

  try {
    // ===== YOUTUBE =====
    if (url.includes('youtube.com') || url.includes('youtu.be')) {

      // youtu.be/ID
      if (url.includes('youtu.be/')) {
        const id = url.split('youtu.be/')[1].split(/[?&/]/)[0];
        return { type: 'youtube', id };
      }

      // watch?v=ID
      if (url.includes('watch?v=')) {
        const id = url.split('watch?v=')[1].split('&')[0];
        return { type: 'youtube', id };
      }

      // youtube.com/live/ID
      if (url.includes('/live/')) {
        const id = url.split('/live/')[1].split(/[?&/]/)[0];
        return { type: 'youtube', id };
      }
    }

    // ===== TWITCH =====
    if (url.includes('twitch.tv/')) {
      const id = url.split('twitch.tv/')[1].split(/[?&/]/)[0];
      return { type: 'twitch', id };
    }

    // ===== KICK =====
    if (url.includes('kick.com/')) {
      const id = url.split('kick.com/')[1].split(/[?&/]/)[0];
      return { type: 'kick', id };
    }

  } catch (e) {
    console.error('parseUrl error:', e);
  }

  return null;
}

    // ==================== RENDER ====================
function render() {
  const hasLives = lives.length > 0;

if (!hasLives) {
  el.chatSidebar.classList.remove('open');
  el.ctrlChat.style.display = 'none';
}

  // ===== UI STATE =====
  el.hero.style.display = hasLives ? 'none' : 'flex';
  el.grid.style.display = hasLives ? 'grid' : 'none';
  el.ctrlChat.style.display = hasLives ? 'flex' : 'none';
  el.featuredBtn.style.display = window.featuredLives.length > 0 ? 'flex' : 'none';

  el.grid.innerHTML = '';

  if (!hasLives) {
    el.chatSidebar.classList.remove('open');
    updateChatOptions();
    updateURL();
    return;
  }

  // ===== GRID COLUNAS =====
  let cols;

  if (window.innerWidth <= 768) {
    cols = 1;
  } else {
    cols = lives.length === 1 ? 1 : (lives.length <= 4 ? 2 : 3);
    if (lives.length > 6) cols = 4;
  }

  el.grid.style.gridTemplateColumns = `repeat(${cols}, 1fr)`;

  // ===== RENDER LIVES =====
  lives.forEach((live) => {
    const wrapper = document.createElement('div');
    wrapper.className = 'live-wrapper';

    // Identificação segura
    wrapper.setAttribute('data-type', live.type);
    wrapper.setAttribute('data-id', live.id);

    // ===== EMBED =====
    let src = '';

if (live.type === 'youtube') {
  src = `https://www.youtube.com/embed/${live.id}?autoplay=1&mute=1&rel=0&origin=${window.location.origin}`;
}

    if (live.type === 'twitch') {
      src = `https://player.twitch.tv/?channel=${live.id}&parent=${window.location.hostname}&autoplay=true&muted=true`;
    }

    if (live.type === 'kick') {
      src = `https://player.kick.com/${live.id}?muted=true`;
    }

    wrapper.innerHTML = `
      <div class="live-controls">
        <button class="btn btn-icon delete-live">
          <i class="ph ph-x"></i>
        </button>
      </div>
<iframe 
  src="${src}" 
  allowfullscreen 
  referrerpolicy="strict-origin-when-cross-origin"
  sandbox="allow-scripts allow-same-origin allow-presentation allow-modals">
</iframe>
    `;

    // ===== DRAG =====
    wrapper.draggable = true;

    wrapper.addEventListener('dragstart', () => {
      wrapper.classList.add('dragging');
    });

    wrapper.addEventListener('dragend', () => {
      wrapper.classList.remove('dragging');

      const newOrder = [...el.grid.children].map(child => {
        const type = child.getAttribute('data-type');
        const id = child.getAttribute('data-id');
        return lives.find(l => l.type === type && l.id === id);
      });

      lives = newOrder.filter(Boolean);
      localStorage.setItem('lives', JSON.stringify(lives));
    });

    el.grid.appendChild(wrapper);
  });

  

  // ===== FINALIZA =====
  updateChatOptions();
  updateURL();
  resetAutoHide();
}



    el.grid.addEventListener('dragover', e => {
  e.preventDefault();
  const dragging = document.querySelector('.dragging');
  const afterElement = [...el.grid.children].find(child => {
    const box = child.getBoundingClientRect();
    return e.clientY < box.top + box.height / 2;
  });

  if (afterElement) {
    el.grid.insertBefore(dragging, afterElement);
  } else {
    el.grid.appendChild(dragging);
  }
});

document.addEventListener('click', function(e){
  const btn = e.target.closest('.delete-live');
  if(!btn) return;

  if(!btn.classList.contains('confirming')){
    btn.classList.add('confirming');
    btn.style.background = '#ff4444';
    setTimeout(()=>{
      btn.classList.remove('confirming');
      btn.style.background = '';
    },2000);
  } else {
  const type = btn.closest('.live-wrapper').getAttribute('data-type');
const id = btn.closest('.live-wrapper').getAttribute('data-id');

lives = lives.filter(l => !(l.type === type && l.id === id));
localStorage.setItem('lives', JSON.stringify(lives));
render();
  }
});

function updateChatOptions() {
  if (!lives.length) {
    el.chatSidebar.classList.remove('open');
    return;
  }
const selText = t("chat_sel");
      const opts = lives.map((l,i) => `<option value="${i}">${l.id.toUpperCase()} (${l.type})</option>`).join('');
      el.chatSelect1.innerHTML = `<option value="">${selText} 1</option>${opts}`;
      el.chatSelect2.innerHTML = `<option value="">${selText} 2</option>${opts}`;
}

    function loadChat(idx, slot) {
      if (!idx) return;
      const live = lives[idx];
      const frame = slot === 1 ? el.chatFrame1 : el.chatFrame2;
      frame.style.display = 'block';
      if (live.type === 'youtube') frame.src = `https://www.youtube.com/live_chat?v=${live.id}&embed_domain=${location.hostname}`;
      if (live.type === 'twitch') frame.src = `https://www.twitch.tv/embed/${live.id}/chat?parent=${window.location.hostname}&darkpopout`;
      if (live.type === 'kick') frame.src = `https://kick.com/${live.id}/chatroom`;
    }

    window.removeLive = (idx) => {
      lives.splice(idx, 1);
      localStorage.setItem('lives', JSON.stringify(lives));
      render();
    };

    // ==================== URL SHARING ====================
    function loadFromURL() {
      const params = new URLSearchParams(location.search);
      const str = params.get('lives');
      if (!str) return false;
      lives = str.split(',').map(s => {
        const [t, id] = s.split(':');
        const type = t === 'yt' ? 'youtube' : t === 'tw' ? 'twitch' : t;
        return type && id ? {type, id} : null;
      }).filter(Boolean);
      localStorage.setItem('lives', JSON.stringify(lives));
      return true;
    }

    function updateURL() {
      if (!lives.length) {
        history.replaceState({}, '', location.pathname);
        return;
      }
      const str = lives.map(l => {
        let t = l.type;
        if (t === 'youtube') t = 'yt';
        else if (t === 'twitch') t = 'tw';
        return `${t}:${l.id}`;
      }).join(',');
      history.replaceState({}, '', `?lives=${str}`);
    }

    // ==================== DESTAQUES (sem duplicar) ====================
    function renderFeatured() {
      el.featuredGrid.innerHTML = '';
      if (!window.featuredLives || !window.featuredLives.length) {
        el.featuredGrid.innerHTML = `<p style="text-align:center;color:var(--text-dim);padding:80px 20px;">${t("no_featured")}</p>`;
        return;
      }

      window.featuredLives.forEach(group => {
        const card = document.createElement('div');
        card.className = 'featured-card';

        let previewHTML = group.lives.map(url => {
          const d = parseUrl(url) || {id: url.split('/').pop()};
          return `<div>${(d.type||'???').toUpperCase()} • ${d.id}</div>`;
        }).join('');

        card.innerHTML = `
          <div class="featured-header">
            <div class="featured-title">${group.name}</div>
            <div class="featured-count">${t("featuredCount", { count: group.lives.length }, group.lives.length)}</div>
          </div>
          <div class="featured-preview">${previewHTML}</div>
          <div class="featured-action">
            <button class="btn btn-primary" style="width:100%;">${t("addToGrid")}</button>
          </div>
        `;

        card.querySelector('button').onclick = () => {
          let added = 0;
          group.lives.forEach(url => {
            const data = parseUrl(url);
            if (data && !lives.some(l => l.type === data.type && l.id === data.id)) {
              lives.push(data);
              added++;
            }
          });

          if (added > 0) {
            localStorage.setItem('lives', JSON.stringify(lives));
            render();
            showToast("toastAdded", { count: added }, added);
          } else {
            showToast("toastAllAdded");
          }
          toggleFeatured(false);
        };

        el.featuredGrid.appendChild(card);
      });
    }

    function toggleFeatured(show) {
      el.overlay.classList.toggle('active', show);
      el.modalFeatured.classList.toggle('active', show);
      if (show) renderFeatured();
    }

    // ==================== MODAL ADICIONAR ====================
    function toggleAddModal(show) {
      el.overlay.classList.toggle('active', show);
      el.modalAdd.classList.toggle('active', show);
      if (show) {
        el.urlInput.value = '';
        setTimeout(() => el.urlInput.focus(), 100);
      }
    }
    

    // ==================== EVENTOS ====================
    el.toggleSelectors.onclick = () => {
      const collapsed = el.chatSelectors.classList.toggle('collapsed');
      el.toggleIcon.className = collapsed ? 'ph ph-caret-down' : 'ph ph-caret-up';
    };

    // Botões de adicionar
    document.getElementById('add-btn').onclick =
    document.getElementById('hero-start').onclick =
    document.getElementById('ctrl-add').onclick = () => toggleAddModal(true);

    // Fechar modais
    document.getElementById('modal-cancel').onclick =
    document.getElementById('close-featured').onclick =
    el.overlay.onclick = () => {
      toggleAddModal(false);
      toggleFeatured(false);
    };

    // Confirmar adicionar live
    document.getElementById('modal-confirm').onclick = () => {
      const data = parseUrl(el.urlInput.value);
      if (data && !lives.some(l => l.type === data.type && l.id === data.id)) {
  lives.push(data);
        localStorage.setItem('lives', JSON.stringify(lives));
        toggleAddModal(false);
        render();
        showToast('toast_live');
      }
    };

    // Chat
    el.ctrlChat.onclick = () => {
  el.chatSidebar.classList.toggle('open');

  if (window.innerWidth <= 768) {
    setTimeout(() => {
      el.chatSidebar.scrollIntoView({ behavior: "smooth" });
    }, 200);
  }
};
    document.getElementById('close-chat').onclick = () => el.chatSidebar.classList.remove('open');

    el.chatSelect1.onchange = e => loadChat(e.target.value, 1);
    el.chatSelect2.onchange = e => loadChat(e.target.value, 2);

    document.getElementById('dual-btn').onclick = () => {
      const show = el.chatSelect2.style.display === 'none';
      el.chatSelect2.style.display = el.chatFrame2.style.display = show ? 'block' : 'none';
    };

    // Controle de interface (eye)
    document.getElementById('ctrl-eye').onclick = () => {
      uiVisible = !uiVisible;
      el.header.classList.toggle('hidden', !uiVisible);
      el.main.classList.toggle('full-screen', !uiVisible);
      document.querySelector('#ctrl-eye i').className = uiVisible ? 'ph ph-eye-slash' : 'ph ph-eye';
      showToast(uiVisible ? 'toast_visible' : 'toast_focus');
      if (uiVisible) resetAutoHide();
    };

    // Clear com confirmação dupla
    el.clearBtn.onclick = () => {
      if (!isConfirmingClear) {
        isConfirmingClear = true;
        el.clearBtn.classList.add('btn-danger', 'confirming');
        showToast('clear_confirm');
        clearTimer = setTimeout(() => {
          isConfirmingClear = false;
          el.clearBtn.classList.remove('btn-danger', 'confirming');
        }, 3000);
      } else {
        clearTimeout(clearTimer);
        isConfirmingClear = false;
        el.clearBtn.classList.remove('confirming');
        lives = [];
        localStorage.setItem('lives', '[]');
        render();
        showToast('toast_clear');
      }
    };

    //chat
    document.addEventListener('DOMContentLoaded', () => {
  if (window.innerWidth <= 768) {
    el.chatSidebar.classList.remove('open');
  }
});

    // Fullscreen
    document.getElementById('ctrl-expand').onclick = () => {
      if (!document.fullscreenElement) document.documentElement.requestFullscreen();
      else document.exitFullscreen();
    };

    // Destaques
    el.featuredBtn.onclick = () => toggleFeatured(true);

    // Doar
    el.donateBtn.onclick = () => window.open('https://linktr.ee/santnasc', '_blank');

    // ==================== SUPABASE DESTAQUES (tempo real) ====================
    import('https://esm.sh/@supabase/supabase-js@2').then(({ createClient }) => {
      const supabase = createClient(
        'https://xygmdunlrbtyslvkqvyr.supabase.co',
        'sb_publishable_QKG5wJZ-qqPrXzZo8wmrFg_LEsjBGff'
      );

      async function loadFeatured() {
        const { data } = await supabase.from('featured').select('*').order('name');
        window.featuredLives = data || [];
        el.featuredBtn.style.display = window.featuredLives.length ? 'flex' : 'none';
        if (window.featuredLives.length) showToast("featured_updated");
      }

      loadFeatured();

      supabase.channel('featured-changes')
        .on('postgres_changes', { event: '*', schema: 'public', table: 'featured' }, loadFeatured)
        .subscribe();
    });

    // ==================== INICIALIZAÇÃO ====================
    document.addEventListener('mousemove', resetAutoHide);
    document.addEventListener('touchstart', resetAutoHide);

    lives = JSON.parse(localStorage.getItem('lives')) || [];
    if (!loadFromURL()) render();
    else render();

    updateTranslations();

    // Mostrar float-bar inicialmente se houver lives
    if (lives.length > 0) {
      el.floatBar.classList.remove('hidden');
    }

     // ==================== scroll float bar ====================
if (window.innerWidth <= 768) {

  let floatTimeout;

  const showFloatBar = () => {
    el.floatBar.classList.add("show");

    clearTimeout(floatTimeout);
    floatTimeout = setTimeout(() => {
      el.floatBar.classList.remove("show");
    }, 2500);
  };

  // Mostrar ao rolar
  window.addEventListener("scroll", () => {
    if (lives.length > 0) showFloatBar();
  });

  // Mostrar ao tocar na tela
  document.addEventListener("touchstart", (e) => {
    // Evita ativar se tocar dentro do próprio float bar
    if (!e.target.closest("#float-bar") && lives.length > 0) {
      showFloatBar();
    }
  });

}
  </script>
</body>
</html>
